description: >
  Runs static analysis tasks against the Dockerfile

docker:
  - image: cimg/node:16.8

parameters:
  dockerfile:
    description: >
      The path to the Dockerfile file
    type: string

steps:
  - run:
      name: Print debug info
      command: |
        echo "
        dockerfile: << parameters.dockerfile >>
        "

  - attach_workspace:
      at: ~/workspace

  - checkout

  - run:
      name: Install dockerlinter
      command: |
        sudo npm install --no-progress --global dockerfilelint

  - run:
      name: Run linter against Dockerfile
      command: |
        dockerfilelint << parameters.dockerfile >>
