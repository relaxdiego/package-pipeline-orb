description: >
  Renders the BUILD-INFO file

docker:
  - image: cimg/base:2020.04

parameters:
  versioning_provider:
    description: Which versioning scheme to use when naming the package.
    type: enum
    enum:
      - semver2
    default: semver2

steps:
  - run:
      name: Print debug info
      command: |
        echo "
        versioning_provider: << parameters.versioning_provider >>
        "

  - checkout

  - run:
      name: Render BUILD-INFO
      environment:
        PIPELINE_VERSIONING_PROVIDER: << parameters.versioning_provider >>
      command: <<include(scripts/render-build-info.sh)>>

  - persist_to_workspace:
      root: .
      paths:
        - BUILD-INFO
